pool: Default

trigger:
  batch: true
  paths:
    include:
      - <path_to_enrich_node>

name: $(Date:yyyyMMdd)$(Seconds)$(Rev:rr) # Used for tagging the node docker image

resources:
  repositories:
    - repository: templates
      type: git
      name: CORE.Utilities/Pipeline.Templates

variables:
  project-acr-service-endpoint: <service_registry_endpoint_name> # Name of the ACR endpoint for the project ACR 
  explorecore-acr-service-endpoint: EXPLORE.CORE ACR Service Connection # Name of the ACR endpoint for the CORE ACR 
  arm-service-connection-endpoint: Azure Resource Manager endpoint # Name of the Azure Resource Manager endpoint
  key-vault-name: <key_vault_name>
  working-directory: $(System.DefaultWorkingDirectory)/<path_to_enrich_node>
  meshnode-name: <meshnode_name>
  project-name: <docker_compose_project_name>

stages:
  - template: enrich-nodes/build.yml@templates # Reference to build template from the CORE.Utilities/Pipeline.Templates repo

